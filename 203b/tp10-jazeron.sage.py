

# This file was *autogenerated* from the file tp10-jazeron.sage
from sage.all_cmdline import *   # import sage library

_sage_const_1841 = Integer(1841); _sage_const_10363 = Integer(10363); _sage_const_22304 = Integer(22304); _sage_const_108021 = Integer(108021); _sage_const_243809 = Integer(243809); _sage_const_1366 = Integer(1366); _sage_const_7695 = Integer(7695); _sage_const_16535 = Integer(16535); _sage_const_80130 = Integer(80130); _sage_const_180869 = Integer(180869); _sage_const_1072 = Integer(1072); _sage_const_6088 = Integer(6088); _sage_const_13069 = Integer(13069); _sage_const_63408 = Integer(63408); _sage_const_143144 = Integer(143144); _sage_const_506 = Integer(506); _sage_const_2951 = Integer(2951); _sage_const_6298 = Integer(6298); _sage_const_30700 = Integer(30700); _sage_const_69343 = Integer(69343); _sage_const_82 = Integer(82); _sage_const_502 = Integer(502); _sage_const_1061 = Integer(1061); _sage_const_5214 = Integer(5214); _sage_const_11788 = Integer(11788); _sage_const_570 = Integer(570); _sage_const_1652 = Integer(1652); _sage_const_8251 = Integer(8251); _sage_const_3807 = Integer(3807); _sage_const_34007 = Integer(34007); _sage_const_178 = Integer(178); _sage_const_522 = Integer(522); _sage_const_2666 = Integer(2666); _sage_const_1196 = Integer(1196); _sage_const_10988 = Integer(10988); _sage_const_540 = Integer(540); _sage_const_1573 = Integer(1573); _sage_const_7866 = Integer(7866); _sage_const_3622 = Integer(3622); _sage_const_32430 = Integer(32430); _sage_const_42 = Integer(42); _sage_const_118 = Integer(118); _sage_const_580 = Integer(580); _sage_const_275 = Integer(275); _sage_const_2387 = Integer(2387); _sage_const_135 = Integer(135); _sage_const_393 = Integer(393); _sage_const_1967 = Integer(1967); _sage_const_905 = Integer(905); _sage_const_8109 = Integer(8109); _sage_const_64 = Integer(64); _sage_const_300 = Integer(300); _sage_const_924 = Integer(924); _sage_const_228 = Integer(228); _sage_const_3168 = Integer(3168); _sage_const_80 = Integer(80); _sage_const_404 = Integer(404); _sage_const_1232 = Integer(1232); _sage_const_304 = Integer(304); _sage_const_4224 = Integer(4224); _sage_const_35 = Integer(35); _sage_const_175 = Integer(175); _sage_const_543 = Integer(543); _sage_const_133 = Integer(133); _sage_const_1848 = Integer(1848); _sage_const_15 = Integer(15); _sage_const_75 = Integer(75); _sage_const_231 = Integer(231); _sage_const_61 = Integer(61); _sage_const_792 = Integer(792); _sage_const_20 = Integer(20); _sage_const_100 = Integer(100); _sage_const_308 = Integer(308); _sage_const_76 = Integer(76); _sage_const_1052 = Integer(1052); _sage_const_5 = Integer(5); _sage_const_0 = Integer(0); _sage_const_1 = Integer(1); _sage_const_2 = Integer(2); _sage_const_10 = Integer(10); _sage_const_3 = Integer(3); _sage_const_4 = Integer(4); _sage_const_6 = Integer(6)
print("""\
# *************************************************************************** #
# *************************************************************************** #
# TP10 : INVARIANTS DE SIMILITUDE ET LFSR                                     #
# *************************************************************************** #
# *************************************************************************** #
""")

# CONSIGNES
#
# Les seules lignes a modifier sont annoncee par "Code pour l'exercice"
# indique en commmentaire et son signalees
# Ne changez pas le nom des variables
#
# CONSEILS
#
# Ce modele vous sert a restituer votre travail. Il est deconseille d'ecrire
# une longue suite d'instruction et de debugger ensuite. Il vaut mieux tester
# le code que vous produisez ligne apres ligne, afficher les resultats et
# controler que les objets que vous definissez sont bien ceux que vous attendez.
#
# Vous devez verifier votre code en le testant, y compris par des exemples que
# vous aurez fabrique vous-meme.
#


reset()
print("""\
# ****************************************************************************
# INVARIANTS DE SIMILITUDE
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

PolQQ = PolynomialRing(QQ, names=('x',)); (x,) = PolQQ._first_ngens(1)

M1 =  matrix(QQ,[[-_sage_const_1841 , -_sage_const_10363 , _sage_const_22304 , _sage_const_108021 , -_sage_const_243809  ],
[_sage_const_1366 , _sage_const_7695 , -_sage_const_16535 , -_sage_const_80130 , _sage_const_180869  ],[
-_sage_const_1072 , -_sage_const_6088 , _sage_const_13069 , _sage_const_63408 , -_sage_const_143144  ],[
_sage_const_506 , _sage_const_2951 , -_sage_const_6298 , -_sage_const_30700 , _sage_const_69343  ],[
_sage_const_82 , _sage_const_502 , -_sage_const_1061 , -_sage_const_5214 , _sage_const_11788 ]])


M2 = matrix(QQ,[[_sage_const_570 , _sage_const_1652 , -_sage_const_8251 , _sage_const_3807 , _sage_const_34007  ],[
-_sage_const_178 , -_sage_const_522 , _sage_const_2666 , -_sage_const_1196 , -_sage_const_10988  ],[
_sage_const_540 , _sage_const_1573 , -_sage_const_7866 , _sage_const_3622 , _sage_const_32430  ],[
-_sage_const_42 , -_sage_const_118 , _sage_const_580 , -_sage_const_275 , -_sage_const_2387  ],[
_sage_const_135 , _sage_const_393 , -_sage_const_1967 , _sage_const_905 , _sage_const_8109 ]])

M3 = matrix(QQ,[[_sage_const_64 , -_sage_const_300 , _sage_const_924 , -_sage_const_228 , _sage_const_3168  ],[
-_sage_const_80 , _sage_const_404 , -_sage_const_1232 , _sage_const_304 , -_sage_const_4224  ],[
_sage_const_35 , -_sage_const_175 , _sage_const_543 , -_sage_const_133 , _sage_const_1848  ],[
-_sage_const_15 , _sage_const_75 , -_sage_const_231 , _sage_const_61 , -_sage_const_792  ],[
-_sage_const_20 , _sage_const_100 , -_sage_const_308 , _sage_const_76 , -_sage_const_1052 ]])


# Code pour l'EXERCICE

Delta1 =  (M1 - x*identity_matrix(QQ,_sage_const_5 )).smith_form()[_sage_const_0 ]
Delta2 =  (M2 - x*identity_matrix(QQ,_sage_const_5 )).smith_form()[_sage_const_0 ]
Delta3 =  (M3 - x*identity_matrix(QQ,_sage_const_5 )).smith_form()[_sage_const_0 ]


Invariants1 = [Delta1[i,i] for i in range(_sage_const_5 ) if Delta1[i,i] != _sage_const_0 ]
Invariants2 = [Delta2[i,i] for i in range(_sage_const_5 ) if Delta2[i,i] != _sage_const_0 ]
Invariants3 = [Delta3[i,i] for i in range(_sage_const_5 ) if Delta1[i,i] != _sage_const_0 ]

Polmin1 = -Invariants1[-_sage_const_1 ]
Polmin2 = -Invariants2[-_sage_const_1 ]
Polmin3 = -Invariants3[-_sage_const_1 ]

Polcar1 = -prod(Invariants1)
Polcar2 = -prod(Invariants2)
Polcar3 = -prod(Invariants3)


# # Affichage des resultats

print("La forme normale de M1 est\n", Delta1)
print("La forme normale de M2 est\n", Delta2)
print( "La forme normale de M3 est\n", Delta3)

print( "\nLes invariants de similitude de M1 sont\n", Invariants1)
print( M1.rational_form(format='invariants'))
print( "Les invariants de similitude de M2 sont\n", Invariants2)
print( M2.rational_form(format='invariants'))
print( "Les invariants de similitude de M3 sont\n", Invariants3)
print( M3.rational_form(format='invariants'))

print( "\nLe polynôme minimal de M1 est ",Polmin1)
print( "et d'après SageMath", M1.minimal_polynomial())
print( "Le polynôme minimal de M2 est ",Polmin2)
print( "et d'après SageMath", M2.minimal_polynomial())
print( "Le polynôme minimal de M3 est ",Polmin3)
print( "et d'après SageMath", M3.minimal_polynomial())

print("Vérification p(M1)")
print( Polmin1(M1))
print( "Vérification p(M2)")
print( Polmin2(M2))
print( "Vérification p(M2)")
print( Polmin3(M3))

print("\nLe polynôme caractéristique de M1 est ",Polcar1)
print( "et d'après SageMath", M1.characteristic_polynomial())
print("\nLe polynôme caractéristique de M2 est ",Polcar2)
print( "et d'après SageMath", M2.characteristic_polynomial())
print( "\nLe polynôme caractéristique de M3 est ",Polcar3)
print("et d'après SageMath", M3.characteristic_polynomial())



print("""\
# ****************************************************************************
# FORME DE FROBENUIS D'UNE MATRICE
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

# idem exercice précédent

# Code pour l'EXERCICE

def mat_compagnon(pol) : 
    R = pol.base_ring()
    n = pol.degree()
    M = matrix(R,n)
    for i in range(n):
        for j in range(n):
            if j == n-_sage_const_1  :
                M[i,j] = -pol[i]
            elif j == i-_sage_const_1  :
                M[i,j] = _sage_const_1 
            else : 
                M[i,j] = _sage_const_0 
    return M


Frob1 = block_matrix([[mat_compagnon(Invariants1[i]) if i == j else _sage_const_0  for i in range(len(Invariants1))] for j in range(len(Invariants1))])
Frob2 = block_matrix([[mat_compagnon(Invariants2[i]) if i == j else _sage_const_0  for i in range(len(Invariants2))] for j in range(len(Invariants2))])
Frob3 = block_matrix([[mat_compagnon(Invariants3[i]) if i == j else _sage_const_0  for i in range(len(Invariants3))] for j in range(len(Invariants3))])

# # Affichage des resultats

print("La forme de Frobenius de M1 est\n", Frob1)
print( "vérification Sagemath \n", M1.rational_form())
print("La forme de Frobenius de M2 est\n", Frob2)
print("vérification Sagemath \n", M1.rational_form())
print("La forme de Frobenius de M3 est\n", Frob3)
print( "vérification Sagemath \n", M3.rational_form())
print("""\
# ****************************************************************************
# FORME DE JORDAN D'UNE MATRICE
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

# idem exercice précédent

# Code pour l'EXERCICE

factos1 = [factor for pol in Invariants1 for factor in list(pol.factor())]
factos2 = [factor for pol in Invariants2 for factor in list(pol.factor())]
factos3 = [factor for pol in Invariants3 for factor in list(pol.factor())]


Jordan1 = block_matrix([[jordan_block(-factos1[i][_sage_const_0 ][_sage_const_0 ],factos1[i][_sage_const_1 ]) if i==j else _sage_const_0  for i in range(len(factos1))]for j in range(len(factos1))])
Jordan2 = block_matrix([[jordan_block(-factos2[i][_sage_const_0 ][_sage_const_0 ],factos2[i][_sage_const_1 ]) if i==j else _sage_const_0  for i in range(len(factos2))]for j in range(len(factos2))])
Jordan3 = block_matrix([[jordan_block(-factos3[i][_sage_const_0 ][_sage_const_0 ],factos3[i][_sage_const_1 ]) if i==j else _sage_const_0  for i in range(len(factos3))]for j in range(len(factos3))])

# # Affichage des resultats

print("La forme de Jordan de M1 est\n", Jordan1)
print( "vérification Sagemath \n", M1.jordan_form())
print( "La forme de Jordan de M2 est\n", Jordan2)
print( "vérification Sagemath \n", M2.jordan_form())
print( "La forme de Jordan de M3 est\n", Jordan3)
print( "vérification Sagemath \n", M3.jordan_form())


reset()
print("""\
# ****************************************************************************
# BERLEKAMP-MASSEY
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

from sage.matrix.berlekamp_massey import berlekamp_massey

F2 = GF(_sage_const_2 )
suite = [F2(_sage_const_1 ),_sage_const_0 ,_sage_const_1 ,_sage_const_1 ,_sage_const_0 ,_sage_const_0 ,_sage_const_0 ,_sage_const_0 ,_sage_const_1 ]
suite = suite+suite+suite+suite
ans = berlekamp_massey(suite)


# Code pour l'EXERCICE


def myBerlekampMassey(r):
    Fq = r[_sage_const_0 ].parent()
    PolFq = PolynomialRing(Fq, names=('x',)); (x,) = PolFq._first_ngens(1)
    c, cstar = PolFq(_sage_const_1 ), PolFq(_sage_const_1 )
    l, dstar = _sage_const_0 , Fq(_sage_const_1 )
    m = -_sage_const_1 
    n = len(r)
    for k in range(n) :
        d = r[k]+sum(c[i]*r[k-i] for i in range(_sage_const_1 ,l+_sage_const_1 ))
        if d != _sage_const_0  : 
            t = c
            c = c - d*(dstar**(-_sage_const_1 ))*cstar*x**(k-m)
            if l <= k/_sage_const_2  :
                l = k+_sage_const_1  - l
                cstar = t
                dstar = d
                m = k
    return c,l
    
    

# # Affichage des resultats

q=_sage_const_2 
Fq = FiniteField(q)
for _ in range(_sage_const_1 ):
    t=randint(_sage_const_1 ,_sage_const_10 )
    r = [Fq.random_element() for _ in range(t) ]
    r = r+r+r+r
    p1 = berlekamp_massey(r)
    p2,_ = myBerlekampMassey(r)
    if p1.reverse()- p2 !=_sage_const_0 :
        print("Erreur")


reset()
print("""\
# ****************************************************************************
# ORBITES D'UN LFRS
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice
# Code pour l'EXERCICE
print("NE PAS TRAITER")
# # Affichage des resultats

reset()
print("""\
# ****************************************************************************
# PERIODES D'UN LFRS
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

F2 = GF(_sage_const_2 )
PolF2 = PolynomialRing(F2, names=('x',)); (x,) = PolF2._first_ngens(1)
chi1 = _sage_const_1  + x + x**_sage_const_2  + x**_sage_const_3  + x**_sage_const_4 
chi2 = _sage_const_1  + x + x**_sage_const_2  + x**_sage_const_4 
chi3 = _sage_const_1  + x**_sage_const_3  + x**_sage_const_6 

F5 = GF(_sage_const_5 )
PolF5 = PolynomialRing(F5, names=('y',)); (y,) = PolF5._first_ngens(1)
chi4 = _sage_const_3  + y**_sage_const_2 
chi5 = _sage_const_3  + _sage_const_3 *y + y**_sage_const_2 


# Code pour l'EXERCICE

def BSGS(chi):
    PolFq = chi.parent()
    x = PolFq.gen()
    Fq = PolFq.base_ring()
    R = PolFq.quotient(chi)
    n = Fq.cardinality()**(chi.degree())-_sage_const_1 
    m = ceil(sqrt(n))
    T = []
    e = R(_sage_const_1 )
    for j in range(m) :
        T.append(e)
        e = e*R(x)
        if j > _sage_const_0  and e == R(_sage_const_1 ) :
            return j
    h = R(x)**(-m)
    gamma = h
    for i in range(_sage_const_1 ,m) :
        for j in range(m) :
            if gamma == T[j] :
                return i*m + j
        gamma = gamma*h


# # Affichage des resultats

print("Période de chi1",  BSGS(chi1))
print("Période de chi2",  BSGS(chi2))
print("Période de chi3",  BSGS(chi3))
print("Période de chi4",  BSGS(chi4))
print("Période de chi5",  BSGS(chi5))


reset()
print("""\
# ****************************************************************************
# SERIES GENERATRICES
# ****************************************************************************
""")


# Donnees de l'enonce de l'exercice

# Code pour l'EXERCICE


print("NE PAS TRAITER")

# # Affichage des resultats


